<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmpoweredAI Tech Community Events</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“…</text></svg>">
    
    <!-- React with Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Include Feather Icons for better compatibility -->
    <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
    
    <style>
        body {
            background-color: #f5f5f5;
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            max-width: 32rem;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .rotate-icon {
            transform: rotate(90deg);
            transition: transform 0.2s;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Main App -->
    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        
        // Simple icon component using Feather Icons
        const Icon = ({ name, className = "", size = 16 }) => {
            const iconRef = useRef();
            
            useEffect(() => {
                if (iconRef.current && window.feather) {
                    feather.replace({
                        width: size,
                        height: size
                    });
                }
            }, []);
            
            return (
                <i ref={iconRef} data-feather={name} className={className}></i>
            );
        };
        
        // Simple Dialog component
        const Dialog = ({ open, onOpenChange, children }) => {
            if (!open) return null;
            
            return (
                <div className="modal-backdrop" onClick={() => onOpenChange(false)}>
                    <div className="modal-content" onClick={e => e.stopPropagation()}>
                        {children}
                    </div>
                </div>
            );
        };
        
        const DialogContent = ({ children, className }) => (
            <div className={`space-y-4 ${className || ''}`}>{children}</div>
        );
        
        const DialogHeader = ({ children }) => (
            <div className="mb-4">{children}</div>
        );
        
        const DialogTitle = ({ children }) => (
            <h3 className="text-xl font-semibold">{children}</h3>
        );
        
        // Admin Panel for exporting events
        const AdminPanel = ({ eventData }) => {
            const [isOpen, setIsOpen] = useState(false);
            
            const handleExportJSON = () => {
                // Create formatted JSON string
                const jsonData = JSON.stringify(eventData, null, 2);
                
                // Create blob and download link
                const blob = new Blob([jsonData], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'events.json';
                a.click();
                URL.revokeObjectURL(url);
            };
            
            const handleCopyJSON = () => {
                const jsonData = JSON.stringify(eventData, null, 2);
                navigator.clipboard.writeText(jsonData)
                    .then(() => alert('JSON copied to clipboard!'))
                    .catch(err => alert('Failed to copy: ' + err));
            };
            
            return (
                <>
                    <button 
                        onClick={() => setIsOpen(true)}
                        className="fixed bottom-4 right-4 bg-gray-700 text-white p-2 rounded-full shadow-lg hover:bg-gray-600"
                        title="Admin Tools"
                    >
                        <Icon name="settings" size={24} />
                    </button>
                    
                    <Dialog open={isOpen} onOpenChange={setIsOpen}>
                        <DialogContent className="sm:max-w-xl">
                            <DialogHeader>
                                <DialogTitle>Admin Tools</DialogTitle>
                            </DialogHeader>
                            
                            <div className="space-y-6">
                                <div>
                                    <h3 className="text-lg font-medium mb-2">Export Options</h3>
                                    <p className="text-gray-600 mb-4">
                                        Export the current calendar data to update your events.json file.
                                    </p>
                                    <div className="flex gap-3">
                                        <button
                                            onClick={handleExportJSON}
                                            className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                        >
                                            <Icon name="download" />
                                            <span>Download events.json</span>
                                        </button>
                                        <button
                                            onClick={handleCopyJSON}
                                            className="flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"
                                        >
                                            <Icon name="clipboard" />
                                            <span>Copy to Clipboard</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                                    <div className="flex items-start">
                                        <div className="flex-shrink-0 mt-0.5">
                                            <Icon name="info" className="text-yellow-400" />
                                        </div>
                                        <div className="ml-3">
                                            <h3 className="text-sm font-medium text-yellow-800">Important Note</h3>
                                            <div className="text-sm text-yellow-700 mt-2">
                                                <p>
                                                    Changes made to events are stored in your browser's local storage. 
                                                    To make these changes permanent in the GitHub repository, download 
                                                    the updated events.json file and replace the existing one in your repo.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </DialogContent>
                    </Dialog>
                </>
            );
        };
        
        // Sponsors View Component
        const SponsorsView = ({ eventData, recurringEvents, formatDate, onEventClick }) => {
            const [expandedSponsors, setExpandedSponsors] = useState({});
            
            // Function to toggle collapse/expand for a sponsor
            const toggleSponsor = (sponsor) => {
                setExpandedSponsors(prev => ({
                    ...prev,
                    [sponsor]: !prev[sponsor]
                }));
            };
            
            // Get all sponsors and their events
            const sponsorsWithEvents = useMemo(() => {
                const sponsors = new Map();
                
                // Helper function to process events for a sponsor
                const processEventForSponsor = (event, sponsorName) => {
                    if (!sponsors.has(sponsorName)) {
                        sponsors.set(sponsorName, []);
                    }
                    sponsors.get(sponsorName).push(event);
                };
                
                // Process one-time events
                eventData.oneTime.forEach(event => {
                    if (event.sponsors && event.sponsors.length > 0) {
                        event.sponsors.forEach(sponsor => {
                            processEventForSponsor(event, sponsor);
                        });
                    }
                });
                
                // Process recurring events
                recurringEvents.forEach(event => {
                    if (event.sponsors && event.sponsors.length > 0) {
                        event.sponsors.forEach(sponsor => {
                            processEventForSponsor(event, sponsor);
                        });
                    }
                });
                
                // Convert to array and sort by sponsor name
                return Array.from(sponsors.entries())
                    .sort((a, b) => a[0].localeCompare(b[0]))
                    .map(([sponsor, events]) => ({
                        name: sponsor,
                        events: events.sort((a, b) => new Date(a.date) - new Date(b.date))
                    }));
            }, [eventData, recurringEvents]);
            
            // Initialize all sponsors to be expanded by default
            useEffect(() => {
                const initialExpandState = {};
                sponsorsWithEvents.forEach(sponsor => {
                    initialExpandState[sponsor.name] = true; // Start expanded
                });
                setExpandedSponsors(initialExpandState);
            }, [sponsorsWithEvents]);
            
            // The event card component
            const EventCard = ({ event }) => {
                const eventDate = new Date(event.date);
                const formattedDate = `${eventDate.getDate()} ${MONTHS[eventDate.getMonth()]}`;
                
                return (
                    <div 
                        className={`${EVENT_COLORS[event.type]} p-3 rounded mb-2 cursor-pointer hover:opacity-90`}
                        onClick={() => onEventClick(event)}
                    >
                        <div className="flex justify-between items-center">
                            <div>
                                <span className="font-semibold">{event.title}</span>
                                <div className="text-sm">
                                    <span className="flex items-center gap-1">
                                        <Icon name="calendar" />
                                        {formattedDate}
                                    </span>
                                </div>
                            </div>
                            <div className="flex items-center gap-1">
                                {event.needsSponsors && <Icon name="dollar-sign" />}
                                {event.newsWorthy && <Icon name="star" />}
                                {event.isMajor && <Icon name="zap" className="text-yellow-500" />}
                            </div>
                        </div>
                    </div>
                );
            };
            
            if (sponsorsWithEvents.length === 0) {
                return (
                    <div className="p-6 bg-white rounded-lg shadow-md">
                        <h2 className="text-2xl font-bold mb-4">No sponsors found</h2>
                        <p>There are currently no events with sponsors in the calendar.</p>
                    </div>
                );
            }
            
            return (
                <div className="space-y-6">
                    <h1 className="text-3xl font-bold">Event Sponsors</h1>
                    
                    {sponsorsWithEvents.map(sponsor => (
                        <div key={sponsor.name} className="bg-white rounded-lg shadow-md overflow-hidden">
                            <div 
                                className="p-4 bg-gray-50 flex justify-between items-center cursor-pointer hover:bg-gray-100"
                                onClick={() => toggleSponsor(sponsor.name)}
                            >
                                <h2 className="text-xl font-semibold">{sponsor.name}</h2>
                                <div className={`transition-transform ${expandedSponsors[sponsor.name] ? 'rotate-90' : ''}`}>
                                    <Icon name="chevron-right" />
                                </div>
                            </div>
                            
                            {expandedSponsors[sponsor.name] && (
                                <div className="p-4">
                                    <p className="mb-3 text-gray-600">
                                        Sponsoring {sponsor.events.length} event{sponsor.events.length !== 1 ? 's' : ''}
                                    </p>
                                    <div className="space-y-2">
                                        {sponsor.events.map(event => (
                                            <EventCard key={event.id} event={event} />
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    ))}
                </div>
            );
        };
        
        // Event Creator Component
        const EventCreator = ({ onSaveEvent, onCancel }) => {
            const [formData, setFormData] = useState({
                title: "",
                type: "meetup",
                date: "",
                description: "",
                organizer: "",
                sponsors: "",
                needsSponsors: false,
                isMajor: false,
                newsWorthy: false,
                location: ""
            });
            
            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: type === 'checkbox' ? checked : value
                }));
            };
            
            const handleSubmit = (e) => {
                e.preventDefault();
                
                // Process sponsors string into array
                const sponsorsArray = formData.sponsors
                    ? formData.sponsors.split(',').map(s => s.trim()).filter(s => s !== "")
                    : [];
                
                // Create event object
                const newEvent = {
                    id: `event-${Date.now()}`,
                    title: formData.title,
                    type: formData.type,
                    date: formData.date,
                    description: formData.description,
                    organizer: formData.organizer,
                    sponsors: sponsorsArray,
                    needsSponsors: formData.needsSponsors,
                    isMajor: formData.isMajor,
                    newsWorthy: formData.newsWorthy,
                    location: formData.location
                };
                
                onSaveEvent(newEvent);
            };
            
            return (
                <div className="p-4">
                    <h2 className="text-2xl font-bold mb-4">Create New Event</h2>
                    <form onSubmit={handleSubmit} className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Event Title*
                            </label>
                            <input
                                type="text"
                                name="title"
                                value={formData.title}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                required
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Event Type*
                            </label>
                            <select
                                name="type"
                                value={formData.type}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                required
                            >
                                <option value="meetup">Meetup</option>
                                <option value="workshop">Workshop</option>
                                <option value="conference">Conference</option>
                                <option value="hackathon">Hackathon</option>
                            </select>
                        </div>
                        
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Date*
                            </label>
                            <input
                                type="date"
                                name="date"
                                value={formData.date}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                required
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Description*
                            </label>
                            <textarea
                                name="description"
                                value={formData.description}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                rows="3"
                                required
                            ></textarea>
                        </div>
                        
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Organizer*
                            </label>
                            <input
                                type="text"
                                name="organizer"
                                value={formData.organizer}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                required
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Location
                            </label>
                            <input
                                type="text"
                                name="location"
                                value={formData.location}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-medium text-gray-700 mb-1">
                                Sponsors (comma separated)
                            </label>
                            <input
                                type="text"
                                name="sponsors"
                                value={formData.sponsors}
                                onChange={handleChange}
                                className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                placeholder="EmpoweredAI, TechCorp, etc."
                            />
                        </div>
                        
                        <div className="space-y-2">
                            <div className="flex items-center">
                                <input
                                    type="checkbox"
                                    id="needsSponsors"
                                    name="needsSponsors"
                                    checked={formData.needsSponsors}
                                    onChange={handleChange}
                                    className="h-4 w-4 text-blue-600 border-gray-300 rounded"
                                />
                                <label htmlFor="needsSponsors" className="ml-2 block text-sm text-gray-700">
                                    Needs Sponsors
                                </label>
                            </div>
                            
                            <div className="flex items-center">
                                <input
                                    type="checkbox"
                                    id="isMajor"
                                    name="isMajor"
                                    checked={formData.isMajor}
                                    onChange={handleChange}
                                    className="h-4 w-4 text-blue-600 border-gray-300 rounded"
                                />
                                <label htmlFor="isMajor" className="ml-2 block text-sm text-gray-700">
                                    Major Event
                                </label>
                            </div>
                            
                            <div className="flex items-center">
                                <input
                                    type="checkbox"
                                    id="newsWorthy"
                                    name="newsWorthy"
                                    checked={formData.newsWorthy}
                                    onChange={handleChange}
                                    className="h-4 w-4 text-blue-600 border-gray-300 rounded"
                                />
                                <label htmlFor="newsWorthy" className="ml-2 block text-sm text-gray-700">
                                    News Worthy
                                </label>
                            </div>
                        </div>
                        
                        <div className="flex gap-3 pt-2">
                            <button
                                type="submit"
                                className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
                            >
                                Save Event
                            </button>
                            <button
                                type="button"
                                onClick={onCancel}
                                className="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400"
                            >
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            );
        };
        
        const MONTHS = [
            'January', 'February', 'March', 'April', 'May', 'June',
            'July', 'August', 'September', 'October', 'November', 'December'
        ];

        const EVENT_COLORS = {
            workshop: 'bg-red-400',
            conference: 'bg-green-400',
            hackathon: 'bg-purple-400',
            meetup: 'bg-yellow-400',
            recurring: 'bg-blue-400'
        };

        function getNthDayOfMonth(year, month, dayOfWeek, n) {
            const firstDay = new Date(year, month, 1);
            const firstTargetDay = new Date(firstDay);
            
            // Adjust to first occurrence of target day
            while (firstTargetDay.getDay() !== dayOfWeek) {
                firstTargetDay.setDate(firstTargetDay.getDate() + 1);
            }
            
            // Add weeks to get to nth occurrence
            const targetDay = new Date(firstTargetDay);
            targetDay.setDate(firstTargetDay.getDate() + (n - 1) * 7);
            
            // If we've moved to next month, return null
            if (targetDay.getMonth() !== month) return null;
            
            return targetDay;
        }
        
        // Function to merge original data with local storage data
        const mergeWithLocalStorage = (originalData) => {
            const localEvents = localStorage.getItem('techCalendarEvents');
            
            if (!localEvents) {
                return originalData;
            }
            
            try {
                const parsedLocalEvents = JSON.parse(localEvents);
                
                // Return merged data
                return {
                    recurring: originalData.recurring,
                    oneTime: [...originalData.oneTime, ...parsedLocalEvents]
                };
            } catch (error) {
                console.error('Error parsing local events:', error);
                return originalData;
            }
        };

        const TechCalendar = () => {
            const [baseEventData, setBaseEventData] = useState({ recurring: [], oneTime: [] });
            const [localEvents, setLocalEvents] = useState([]);
            const [selectedEvent, setSelectedEvent] = useState(null);
            const [isDialogOpen, setIsDialogOpen] = useState(false);
            const [viewMode, setViewMode] = useState('calendar'); // 'calendar' or 'sponsors'
            const [error, setError] = useState(null);
            const [loading, setLoading] = useState(true);
            const [isCreateEventOpen, setIsCreateEventOpen] = useState(false);
            
            // Combined event data (base + local)
            const eventData = useMemo(() => {
                return {
                    recurring: baseEventData.recurring,
                    oneTime: [...baseEventData.oneTime, ...localEvents]
                };
            }, [baseEventData, localEvents]);

            // Load events from remote and local storage
            useEffect(() => {
                const loadEvents = async () => {
                    setLoading(true);
                    
                    // Try to load events from local storage first
                    const storedEvents = localStorage.getItem('techCalendarEvents');
                    let localEventsList = [];
                    
                    if (storedEvents) {
                        try {
                            localEventsList = JSON.parse(storedEvents);
                            setLocalEvents(localEventsList);
                        } catch (error) {
                            console.error('Error parsing local events:', error);
                            // Clear corrupted data
                            localStorage.removeItem('techCalendarEvents');
                        }
                    }
                    
                    // Then try to fetch events from remote
                    const possiblePaths = [
                        './public/data/events.json',
                        './data/events.json',
                        './events.json'
                    ];
                    
                    let fetchedRemote = false;
                    
                    for (const path of possiblePaths) {
                        try {
                            console.log(`Attempting to fetch from: ${path}`);
                            const response = await fetch(path);
                            
                            if (response.ok) {
                                const data = await response.json();
                                console.log('Data fetched successfully from:', path);
                                setBaseEventData(data);
                                fetchedRemote = true;
                                break;
                            }
                        } catch (err) {
                            console.log(`Failed to fetch from ${path}:`, err);
                        }
                    }
                    
                    if (!fetchedRemote && localEventsList.length === 0) {
                        setError("Couldn't load calendar data. Please check the events.json location.");
                    } else if (!fetchedRemote) {
                        // We have local events but no remote - create an empty base
                        setBaseEventData({ recurring: [], oneTime: [] });
                    }
                    
                    setLoading(false);
                };
                
                loadEvents();
            }, []);

            // Initialize feather icons after render
            useEffect(() => {
                if (window.feather) {
                    feather.replace();
                }
            });
            
            // Handle toggle between calendar and sponsors view
            const toggleView = () => {
                console.log("Toggle view, current mode:", viewMode);
                setViewMode(viewMode === 'calendar' ? 'sponsors' : 'calendar');
            };

            const recurringEvents = useMemo(() => {
                const events = [];
                const year = 2025;

                eventData.recurring.forEach(event => {
                    for (let month = 0; month < 12; month++) {
                        event.occurrences.forEach(occurrence => {
                            const date = getNthDayOfMonth(year, month, event.dayOfWeek, occurrence);
                            if (date) {
                                events.push({
                                    ...event,
                                    date: date.toISOString(),
                                    id: `${event.id}-${date.toISOString()}`
                                });
                            }
                        });
                    }
                });

                return events;
            }, [eventData.recurring]);

            const getEventsForMonth = (monthIndex) => {
                const oneTimeEvents = eventData.oneTime.filter(
                    event => new Date(event.date).getMonth() === monthIndex
                );

                const monthlyRecurringEvents = recurringEvents.filter(
                    event => new Date(event.date).getMonth() === monthIndex
                );

                return [...oneTimeEvents, ...monthlyRecurringEvents].sort(
                    (a, b) => new Date(a.date) - new Date(b.date)
                );
            };

            // Helper function to format date
            const formatDate = (dateStr) => {
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-US', { 
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    weekday: 'long'
                });
            };
            
            // Handle clicking on an event
            const handleEventClick = (event) => {
                setSelectedEvent(event);
                setIsDialogOpen(true);
            };
            
            // Handle creating a new event
            const handleSaveEvent = (newEvent) => {
                // Add the new event to local storage
                const updatedLocalEvents = [...localEvents, newEvent];
                setLocalEvents(updatedLocalEvents);
                
                // Save to localStorage
                localStorage.setItem('techCalendarEvents', JSON.stringify(updatedLocalEvents));
                
                // Close the create event dialog
                setIsCreateEventOpen(false);
                
                // Show a success message
                alert(`Event "${newEvent.title}" has been created and saved to your browser!`);
            };

            if (loading) {
                return <div className="text-center p-4">Loading calendar data...</div>;
            }

            if (error) {
                return (
                    <div className="p-6 max-w-6xl mx-auto">
                        <div className="text-red-500 text-center p-4 bg-red-100 border-red-300 border rounded-lg">
                            <h2 className="text-xl font-bold mb-2">Error Loading Calendar</h2>
                            <p>{error}</p>
                            <div className="mt-4 p-4 bg-yellow-50 border-yellow-200 border rounded text-left">
                                <h3 className="font-semibold mb-2">Troubleshooting Help:</h3>
                                <p className="mb-2">It looks like we couldn't find your events.json file. Here's how to fix it:</p>
                                <ol className="list-decimal pl-5 space-y-1">
                                    <li>Make sure your events.json file exists in one of these locations:
                                        <ul className="list-disc pl-5 mt-1">
                                            <li>public/data/events.json</li>
                                            <li>data/events.json</li>
                                            <li>events.json (at root)</li>
                                        </ul>
                                    </li>
                                    <li>If you need to move the file, copy it to the root directory of your repository.</li>
                                    <li>Ensure the file has proper JSON format.</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                );
            }
            
            return (
                <div className="p-6 max-w-6xl mx-auto">
                    <div className="flex justify-between items-center mb-6">
                        <h1 className="text-3xl font-bold">
                            {viewMode === 'sponsors' ? 'Tech Community Sponsors' : '2025 Tech Community Calendar'}
                        </h1>
                        <div className="flex gap-3">
                            <button
                                onClick={() => setIsCreateEventOpen(true)}
                                className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"
                            >
                                <span>Create Event</span>
                                <Icon name="plus" />
                            </button>
                            <button
                                onClick={toggleView}
                                className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                            >
                                {viewMode === 'sponsors' ? (
                                    <>
                                        <span>Show Calendar</span>
                                        <Icon name="calendar" />
                                    </>
                                ) : (
                                    <>
                                        <span>See Sponsors</span>
                                        <Icon name="users" />
                                    </>
                                )}
                            </button>
                        </div>
                    </div>
                    
                    {/* Message about local storage */}
                    {localEvents.length > 0 && (
                        <div className="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                            <div className="flex">
                                <div className="flex-shrink-0">
                                    <Icon name="info" className="text-blue-400" />
                                </div>
                                <div className="ml-3">
                                    <p className="text-sm text-blue-700">
                                        You have {localEvents.length} locally created event{localEvents.length !== 1 ? 's' : ''}.
                                        Use the Admin Tools button at the bottom right to export all events.
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Calendar View */}
                    {viewMode === 'calendar' && (
                        <>
                            <div className="space-y-6 mb-8">
                                <div className="flex flex-wrap gap-4 justify-center">
                                    {Object.entries(EVENT_COLORS).map(([type, color]) => (
                                        <div key={type} className="flex items-center gap-2">
                                            <div className={`w-4 h-4 rounded ${color}`}></div>
                                            <span className="capitalize">{type}</span>
                                        </div>
                                    ))}
                                </div>
                                
                                <div className="flex flex-wrap gap-4 justify-center">
                                    <div className="flex items-center gap-2">
                                        <Icon name="zap" className="text-yellow-500" />
                                        <span>Major Event</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <Icon name="star" />
                                        <span>News Worthy</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <Icon name="home" />
                                        <span>Has Sponsors</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <Icon name="dollar-sign" />
                                        <span>Needs Sponsors</span>
                                    </div>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                {MONTHS.map((month, index) => (
                                    <div key={month} className="bg-white rounded-lg shadow-md p-4">
                                        <h2 className="text-xl font-semibold mb-4">{month}</h2>
                                        <div className="space-y-2">
                                            {getEventsForMonth(index).map(event => (
                                                <div
                                                    key={event.id}
                                                    onClick={() => handleEventClick(event)}
                                                    className={`${EVENT_COLORS[event.type]} p-2 rounded cursor-pointer hover:opacity-90 transition-opacity`}
                                                >
                                                    <div className="flex items-center justify-between">
                                                        <span className={`${event.isMajor ? 'text-lg font-bold' : ''}`}>
                                                            {new Date(event.date).getDate()}: {event.title}
                                                        </span>
                                                        <div className="flex items-center gap-1">
                                                            {event.needsSponsors && <Icon name="dollar-sign" />}
                                                            {event.sponsors?.length > 0 && <Icon name="home" />}
                                                            {event.newsWorthy && <Icon name="star" />}
                                                            {event.isMajor && <Icon name="zap" className="text-yellow-500" />}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                            {getEventsForMonth(index).length === 0 && (
                                                <div className="text-gray-500 italic text-center p-2">
                                                    No events scheduled
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </>
                    )}
                    
                    {/* Sponsors View */}
                    {viewMode === 'sponsors' && (
                        <SponsorsView 
                            eventData={eventData} 
                            recurringEvents={recurringEvents} 
                            formatDate={formatDate}
                            onEventClick={handleEventClick}
                        />
                    )}

                    {/* Event Details Dialog */}
                    <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>
                        {selectedEvent && (
                            <DialogContent className="sm:max-w-md">
                                <DialogHeader>
                                    <DialogTitle>{selectedEvent.title}</DialogTitle>
                                </DialogHeader>
                                <div className="space-y-4">
                                    <p>{selectedEvent.description}</p>
                                    <div className="flex items-center gap-2">
                                        <Icon name="calendar" />
                                        <span>{formatDate(selectedEvent.date)}</span>
                                    </div>
                                    {selectedEvent.location && (
                                        <div className="flex items-center gap-2">
                                            <Icon name="map-pin" />
                                            <span>{selectedEvent.location}</span>
                                        </div>
                                    )}
                                    {selectedEvent.organizer && (
                                        <div className="flex items-center gap-2">
                                            <Icon name="user" />
                                            <span>Organizer: {selectedEvent.organizer}</span>
                                        </div>
                                    )}
                                    {selectedEvent.organizers && (
                                        <div className="flex items-center gap-2">
                                            <Icon name="users" />
                                            <span>Organizers: {selectedEvent.organizers.join(', ')}</span>
                                        </div>
                                    )}
                                    {selectedEvent.sponsors?.length > 0 && (
                                        <div className="flex items-center gap-2">
                                            <Icon name="home" />
                                            <span>Sponsors: {selectedEvent.sponsors.join(', ')}</span>
                                        </div>
                                    )}
                                    {selectedEvent.needsSponsors && (
                                        <div className="flex items-center gap-2 text-amber-600">
                                            <Icon name="dollar-sign" />
                                            <span>Seeking Sponsors</span>
                                        </div>
                                    )}
                                    {selectedEvent.isMajor && (
                                        <div className="flex items-center gap-2 text-yellow-500">
                                            <Icon name="zap" />
                                            <span>Major Event</span>
                                        </div>
                                    )}
                                    {selectedEvent.newsWorthy && (
                                        <div className="flex items-center gap-2">
                                            <Icon name="star" />
                                            <span>News Worthy Event</span>
                                        </div>
                                    )}
                                    <a
                                        href="#"
                                        onClick={(e) => {
                                            e.preventDefault();
                                            // TODO: Implement calendar download
                                            alert('Calendar download feature coming soon!');
                                        }}
                                        className="flex items-center gap-2 text-blue-600 hover:text-blue-800"
                                    >
                                        <Icon name="download" />
                                        Add to Calendar
                                    </a>
                                </div>
                            </DialogContent>
                        )}
                    </Dialog>
                    
                    {/* Create Event Dialog */}
                    <Dialog open={isCreateEventOpen} onOpenChange={setIsCreateEventOpen}>
                        <DialogContent className="sm:max-w-lg">
                            <EventCreator 
                                onSaveEvent={handleSaveEvent}
                                onCancel={() => setIsCreateEventOpen(false)}
                            />
                        </DialogContent>
                    </Dialog>
                    
                    {/* Admin Panel */}
                    <AdminPanel eventData={eventData} />
                </div>
            );
        };

        const App = () => {
            return (
                <div className="container mx-auto px-4">
                    <nav className="py-4">
                        <ul className="flex space-x-4">
                            <li><a href="#calendar" className="text-blue-600 hover:text-blue-800">Calendar</a></li>
                        </ul>
                    </nav>
                    
                    <div id="calendar" className="py-4">
                        <TechCalendar />
                    </div>
                </div>
            );
        };

        // Make sure the DOM is loaded before rendering
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
